<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local Coding Assistant</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; margin: 0; padding: 20px; min-height: 100vh; display: flex; justify-content: center; align-items: center; }
    .chat-container { width: 100%; max-width: 800px; height: 80vh; background: white; border-radius: 12px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; overflow: hidden; }
    .messages { flex: 1; overflow-y: auto; padding: 20px; }
    .user-message { background: #3b82f6; color: white; padding: 12px 16px; border-radius: 12px; margin-left: auto; max-width: 80%; margin-bottom: 12px; }
    .ai-message { background: #f3f4f6; color: #111827; padding: 12px 16px; border-radius: 12px; margin-right: auto; max-width: 80%; margin-bottom: 12px; }
    .code-block { background: #1e293b; color: #86efac; padding: 12px; border-radius: 6px; font-family: 'Courier New', monospace; overflow-x: auto; margin: 8px 0; }
    .typing-indicator { display: flex; padding: 8px; }
    .typing-dot { width: 8px; height: 8px; margin: 0 2px; background-color: #6b7280; border-radius: 50%; animation: typingAnimation 1.4s infinite ease-in-out; }
    @keyframes typingAnimation { 0%, 60%, 100% { transform: translateY(0); } 30% { transform: translateY(-5px); } }
    .error-message { background: #fee2e2; color: #b91c1c; padding: 12px; border-radius: 6px; margin-bottom: 16px; }
    .input-area { padding: 16px; border-top: 1px solid #e5e7eb; background: white; }
    .confirmation-dialog { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center; z-index: 1000; }
    .confirmation-box { background: white; padding: 24px; border-radius: 12px; max-width: 400px; width: 100%; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    function LocalCodingAssistant() {
      const [messages, setMessages] = useState([]);
      const [inputValue, setInputValue] = useState('');
      const [isLoading, setIsLoading] = useState(false);
      const messagesEndRef = useRef(null);

      // Local knowledge base - no API needed
      const codingKnowledge = {
        "hello": "Hello! I'm your local coding assistant. I can help explain programming concepts and show code examples.",
        "hi": "Hi there! Ask me about JavaScript, Python, React, or other programming topics.",
        "function": "A function is a reusable block of code. Here's an example in JavaScript:\n\nfunction greet(name) {\n  return `Hello, ${name}!`;\n}\n\n// Usage:\ngreet('Alice'); // Returns 'Hello, Alice!'",
        "loop": "Loops repeat actions. Common types:\n\n// For loop\nfor (let i = 0; i < 5; i++) {\n  console.log(i);\n}\n\n// While loop\nlet x = 0;\nwhile (x < 5) {\n  console.log(x);\n  x++;\n}",
        "react": "Here's a basic React component:\n\nimport React from 'react';\n\nfunction App() {\n  return (\n    <div>\n      <h1>Hello World</h1>\n    </div>\n  );\n}\n\nexport default App;",
        "python": "Python example:\n\ndef calculate_area(width, height):\n    return width * height\n\nprint(calculate_area(5, 3))  # Output: 15",
        "array": "Working with arrays in JavaScript:\n\nconst fruits = ['apple', 'banana', 'orange'];\n\n// Add to end\nfruits.push('grape');\n\n// Remove last item\nfruits.pop();\n\n// Loop through\nfruits.forEach(fruit => {\n  console.log(fruit);\n});",
        "object": "JavaScript objects store key-value pairs:\n\nconst person = {\n  name: 'Alice',\n  age: 30,\n  greet() {\n    console.log(`Hello, I'm ${this.name}`);\n  }\n};\n\nperson.greet(); // Logs 'Hello, I'm Alice'",
        "promise": "Promises handle async operations:\n\nfunction fetchData() {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      resolve('Data received');\n    }, 1000);\n  });\n}\n\nfetchData().then(data => {\n  console.log(data); // Logs 'Data received' after 1 second\n});",
        "help": "I can explain these programming concepts:\n- Functions\n- Loops\n- Variables\n- Arrays\n- Objects\n- React components\n- Python basics\n\nTry asking about any of these!"
      };

      // Initialize with welcome message
      useEffect(() => {
        const savedMessages = localStorage.getItem('local-coding-messages');
        if (savedMessages) {
          setMessages(JSON.parse(savedMessages));
        } else {
          setMessages([{
            id: '1',
            text: 'Hello! I\'m your local coding assistant. I can explain programming concepts and show code examples - no internet required!',
            sender: 'ai'
          }]);
        }
      }, []);

      // Save messages to localStorage
      useEffect(() => {
        if (messages.length > 0) {
          localStorage.setItem('local-coding-messages', JSON.stringify(messages));
        }
      }, [messages]);

      // Auto-scroll to bottom
      useEffect(() => {
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      }, [messages]);

      const handleSendMessage = () => {
        if (!inputValue.trim()) return;

        // Add user message
        const userMessage = {
          id: Date.now().toString(),
          text: inputValue,
          sender: 'user'
        };
        setMessages(prev => [...prev, userMessage]);
        setInputValue('');

        // Simulate typing delay
        setIsLoading(true);
        setTimeout(() => {
          getLocalResponse(inputValue);
          setIsLoading(false);
        }, 500);
      };

      const getLocalResponse = (prompt) => {
        const lowerPrompt = prompt.toLowerCase();
        let response = "I can help with programming concepts like functions, loops, variables, arrays, and objects. Could you ask about something more specific?";
        
        // Check for matching keywords
        for (const [keyword, answer] of Object.entries(codingKnowledge)) {
          if (lowerPrompt.includes(keyword)) {
            response = answer;
            break;
          }
        }

        // Add AI response
        setMessages(prev => [...prev, {
          id: Date.now().toString() + 1,
          text: response,
          sender: 'ai',
          isCode: response.includes('\n') // Simple code detection
        }]);
      };

      const clearHistory = () => {
        setMessages([{
          id: '1',
          text: 'Hello! I\'m your local coding assistant. I can explain programming concepts and show code examples - no internet required!',
          sender: 'ai'
        }]);
        localStorage.removeItem('local-coding-messages');
      };

      const formatMessage = (text, isCode) => {
        if (isCode) {
          return (
            <pre className="code-block">
              {text.split('\n').map((line, i) => (
                <div key={i}>{line}</div>
              ))}
            </pre>
          );
        }
        return text.split('\n').map((line, i) => <p key={i}>{line}</p>);
      };

      return (
        <div className="chat-container">
          {/* Header */}
          <div className="bg-blue-600 text-white p-4">
            <div className="flex justify-between items-center">
              <h1 className="text-xl font-bold">Local Coding Assistant</h1>
              <button 
                onClick={() => {
                  if (confirm('Clear all chat history?')) {
                    clearHistory();
                  }
                }}
                className="text-sm bg-blue-700 hover:bg-blue-800 px-3 py-1 rounded"
              >
                Clear
              </button>
            </div>
          </div>

          {/* Messages */}
          <div className="messages">
            {messages.map(message => (
              <div
                key={message.id}
                className={message.sender === 'user' ? 'user-message' : 'ai-message'}
              >
                {formatMessage(message.text, message.isCode)}
              </div>
            ))}

            {isLoading && (
              <div className="ai-message">
                <div className="typing-indicator">
                  <div className="typing-dot"></div>
                  <div className="typing-dot"></div>
                  <div className="typing-dot"></div>
                </div>
              </div>
            )}
            <div ref={messagesEndRef} />
          </div>

          {/* Input Area */}
          <div className="input-area">
            <div className="flex gap-2">
              <input
                type="text"
                value={inputValue}
                onChange={(e) => setInputValue(e.target.value)}
                onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}
                placeholder="Ask about programming..."
                className="flex-1 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                disabled={isLoading}
              />
              <button
                onClick={handleSendMessage}
                disabled={!inputValue.trim() || isLoading}
                className="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50"
              >
                Send
              </button>
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<LocalCodingAssistant />);
  </script>
</body>
</html>
